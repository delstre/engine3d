#pragma once

#include <GL/glew.h>

#include <memory>

namespace Engine {
    /**
     * Пространство имён для отладочных утилит: логирование, измерение FPS,
     * использование памяти CPU и GPU.
     */
    namespace Debug {
        /**
         * Выводит произвольное количество аргументов в стандартный вывод через пробел,
         * затем переводит строку. Удобно для отладки.
         * @tparam Args Типы аргументов.
         * @param args Аргументы для вывода.
         */
        template<typename... Args>
        void Log(Args&&... args);

        /**
         * Возвращает процент использования видеопамяти GPU.
         * Использует расширение NVX_gpu_memory_info (требуется поддержка драйвером NVIDIA).
         * @return Значение от 0.0 до 100.0, где 100% – память полностью занята.
         */
        GLfloat GetGPUMemoryUsage();

        /**
         * Возвращает максимальный размер резидентной памяти (RSS) процесса в килобайтах.
         * Использует getrusage().
         * @return Размер памяти в КБ.
         */
        long GetMemoryUsage();

        /**
         * Возвращает текущее значение FPS (количество кадров в секунду),
         * вычисленное в CounterFPS().
         * @return Кадров в секунду.
         */
        double GetFPS();

        /**
         * Считает кадры и обновляет значение FPS.
         * Должен вызываться каждый кадр (например, в конце цикла рендеринга).
         * Обновляет статические переменные fps, frameCount и lastTime.
         */
        void CounterFPS();

        /// Текущее значение FPS (обновляется в CounterFPS).
        static double fps;
        /// Счётчик кадров с последнего сброса (используется в CounterFPS).
        static int frameCount;
        /// Время последнего сброса счётчика (используется в CounterFPS).
        static double lastTime;
    };
}
